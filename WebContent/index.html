<!DOCTYPE html>
<html>
  <head>
    <base href="/myweb/" />

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>快递管理系统</title>
    <link href="css/public.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/global.js"></script>
   <!-- 代码实现-->
 <script>
      // 定义用户名正则表示字符串的规则，用户名规则是6-12位英文字母或数字组成，不能以数字开头
      let userReg = /^[a-zA-Z][a-zA-Z0-9]{5,11}$/;

      // 定义正则表示密码的规则，强密码规则（至少8位，必须包含大小写字母和数字）
      let passwdReg = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/;

   //定义记录账号和密码对应校验状态变量，初始化为false。true表示检验通过，false表示校验不通过。
      let usernameFlag = false;
      let passwordFlag = false;

  // 检验用户名格式是否合法的函数
  function checkUsername(){
      // 获得用户在页面上输入的用户名信息
      let domUserId = document.getElementById("usernameInput")
      let userInput = domUserId.value;
      // 获得用户名格式的提示框
      let userMsg = document.getElementById("accountMsg");
      // 格式有误时,账号校验状态为false,并在用户名格式提示的框中用红色字样提示:用户名格式错误!
      if(!userReg.test(userInput)){
        userMsg.innerHTML = "<font color = 'red'> USERNAME ERR 6-12位英文字母或数字组成，不能以数字开头</font>";
        usernameFlag = false;
        return;
      }
      userMsg.innerHTML= "<font color = 'green'> USERNAME Available </font>";
      usernameFlag = true;

      // 格式OK,账号校验状态为true 并在用户名格式提示的框中用绿色字样提示:用户名可以使用!

  }

  // 检验密码格式是否合法的函数
  function checkUserPwd(){
      // 获得用户在页面上输入的密码信息
      let domPasswdId = document.getElementById("userPwdInput")
      let passValue = domPasswdId.value;
      // 获得密码格式的提示框
      let passMsg = document.getElementById("passwordMsg")
      if(!passwdReg.test(passValue)){
        passMsg.innerHTML= "<font color = 'red'> PASSWD ERR 至少8位，必须包含大小写字母和数字</font>";
        passwordFlag = false;
        return;
      }
      passMsg.innerHTML= "<font color = 'green'> PASSWD Available </font>";
      passwordFlag = true;
      // 格式有误时,密码校验状态为false,并在密码格式提示的框中用红色字样提示:密码格式错误!

      //  格式OK,密码校验状态为true 并在密码格式提示的框中用绿色字样提示:密码可以使用!
     
  }
  
  //确认表单是否可以提交的函数
  function checkForm(){
      // 表单在提交时, 必须确保用户名和密码校验状态都为true，才能提交
      return (usernameFlag && passwordFlag);
  }
  window.onload = function() {
      //add 监听事件
      document.getElementById("usernameInput").onblur = checkUsername;
      document.getElementById("userPwdInput").onblur = checkUserPwd;
      
  }
</script>  
  </head>
  <body>
    <div id="dcWrap">
      <div id="dcMain">
        <!-- 当前位置 -->
        <div id="manager" class="mainBox" style="height: auto !important; height: 550px; min-height: 550px">
          <h3>用户登陆</h3>
          <!-- 提交表单事件onsubmit触发时，必须调用函数来确保用户名和密码校验状态都为true，才能提交。-->
          <form action="api/login" method="post" onsubmit="return checkForm()">
            <table width="100%" border="0" cellpadding="8" cellspacing="0" class="tableBasic" >
              <tr>
                <td width="100" align="right">用户名</td>
                <td>
                  <!-- 用户名文本框失去焦点时，要调用函数来校验用户名格式是否正确 -->
                  <input id="usernameInput" type="text" name="username" size="40" class="inpMain" />
                  &nbsp; &nbsp;
                  <span id="accountMsg"></span> <!--用户验证提示框-->
                </td>
              </tr>
              <tr>
                <td width="100" align="right">密码</td>
                <td>
                  <!-- 密码文本框失去焦点时，要调用函数来校验密码格式是否正确 -->
                  <input id="userPwdInput" type="password" name="password" size="40" class="inpMain"  />
                  &nbsp; &nbsp;
                  <span id="passwordMsg"></span>
                </td>
              </tr>
              <tr>
                <td></td>
                <td>
                  <input type="submit" class="btn" value="登录" /> &nbsp; &nbsp; 
                  <span style="font-weight: bolder;text-decoration: underline solid;"><a href="register.html">注&nbsp;册</a></span>
                </td>
              </tr>
            </table>
          </form>
        </div>
      </div>
      <div class="clear"></div>
      <div id="dcFooter">
        <div id="footer">
          <div class="line"></div>
          <ul>
            版权所有 © 2024-2025 尚硅谷教育，并保留所有权利。
          </ul>
        </div>
      </div>
      <!-- dcFooter 结束 -->
      <div class="clear"></div>
    </div>
  </body>
</html>
